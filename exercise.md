# 网络传输分析、系统设计与实现

wireshark 抓包文件 http.mirror.azure.cn.pcapng 内容描述了使用浏览器访问 http://mirror.azure.cn/ 产生的网络传输数据，请根据文件内容回答以下题目

**提示**: 所有解答源码请放入一个公开 github 仓库，并给出可访问的 url

1. **网络传输分析**: 描述浏览器访问该 url 的整个流程，具体要求如下
    - 描述须包括 IP 以上所有使用到的协议层，按照时间顺序进行描述
    
    
   你好，本地没安装wireshark。下载速度比较慢，用在线工具查看的抓包文件。
   看抓包只有request部分，没人response部分。
   第一步是dns请求，请求了本地dns和远程dns服务器。之后发送http请求 http://mirror.azure.cn/, 然后请求这页面包含的css和图片文件。

2. **服务实现**: 请使用任何后端编程语言，实现一个服务端程序，克隆站点 http://mirror.azure.cn/ 首页的返回结果，具体要求如下
    - 请求该后端与直接请求 http://mirror.azure.cn/ 得到的 HTTP 层结果一致
    - 运行环境使用 **docker** 容器进行封装，并给出启动命令
    
  你好，使用python flask实现web，项目再app目录. 因为原地址看着像个镜像站点，这种一般都是静态站点，所以实现上也主要是用静态文件.
  js讲hash加到文件后缀，来实现缓冲的刷新.

3. **压力测试**: 对第 2 步完成的服务端程序进行一分钟的压力测试，HTTP 请求地址为 /，并输出压力测试结果，具体要求如下
    - 推荐使用 **ApacheBench(Ab)**
    - 若使用其他压力测试工具或自己写程序进行测试，压力测试输出结果请按照 Ab 的结果
    
  参见app目录README.md, `invoke ab` 可以跑ab测试，我本地看一分钟完成27283Requests, 99% requsts延时在4ms以内. 100% 13878ms, 应该是出现来http排队或重试。
  
    
4. **服务优化**: 请根据第 3 步的结果，对服务端程序进行优化，具体要求如下
    - 优化后，浏览器访问的页面渲染结果与优化前一致（目测）
    - 优化后的压力测试结果须表现出**更高的并发量**和**更低的延迟**
    - 请给出服务**性能瓶颈分析**与对应的**优化方式**
    
  因为主要是静态站点，在代码层面优化意义不大， 这种静态站点一般使用脚本将教过静态化后由nginx提供静态文件服务，一般本地测试可实现5w Req/s以上.
  静态站点的优化策略可以考虑gzip压缩, 开启nginx fast_file等，启用cdn缓冲静态文件等思路优化.

